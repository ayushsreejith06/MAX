"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[352],{28325:function(e,l,t){t.d(l,{Z:function(){return f}});var n=t(57437),r=t(2265),o=t(47625),i=t(58336),a=t(56940),s=t(97059),d=t(62994),u=t(8147),c=t(54061),v=t(98728),m=t(92451),g=t(10407);let b=e=>{let{cx:l,cy:t}=e;return void 0===l||void 0===t?null:(0,n.jsx)("circle",{cx:l,cy:t,r:4,fill:"#FFFFFF",stroke:"#171717",strokeWidth:1.5})};function f(e){let{data:l,sectorName:t,sectorSymbol:f,initialWindowHours:x=2,initialTickIncrement:p=10}=e,[h,y]=(0,r.useState)(p),[w,N]=(0,r.useState)(x),[k,j]=(0,r.useState)(0),[S,A]=(0,r.useState)(!0),[_,D]=(0,r.useState)(!1),E="Market Index"===t;(0,r.useEffect)(()=>{h!==p&&y(p)},[p,t,h]),(0,r.useEffect)(()=>{w!==x&&N(x)},[x,t,w]),(0,r.useEffect)(()=>{j(0)},[h,w,t,f]);let F=e=>{let[l,t]=e.split(":").map(Number);return 60*l+t},M=(0,r.useMemo)(()=>l.length?h<=5?l:l.filter(e=>F(e.time)%h==0):[],[l,h]),I=(0,r.useMemo)(()=>{var e,l,t,n;if(!M.length)return{data:[],startTime:"00:00",endTime:"00:00",totalWindows:1};let r=M.map(e=>F(e.time)),o=Math.min(...r),i=60*Math.max(w,1),a=Math.max(1,Math.ceil(Math.max(i,Math.max(...r)-o+h)/i)),s=o+Math.min(k,a-1)*i,d=s+i,u=M.filter(e=>{let l=F(e.time);return l>=s&&l<d}),c=u.length?u:M.slice(-Math.ceil(i/Math.max(h,1))),v=null!==(t=null===(e=c[0])||void 0===e?void 0:e.time)&&void 0!==t?t:M[0].time,m=null!==(n=null===(l=c[c.length-1])||void 0===l?void 0:l.time)&&void 0!==n?n:M[M.length-1].time;return{data:c,startTime:v,endTime:m,totalWindows:a}},[M,w,k,h]);(0,r.useEffect)(()=>{j(e=>Math.min(e,Math.max(I.totalWindows-1,0)))},[I.totalWindows]);let C=(0,r.useMemo)(()=>{let e=I.data.length?I.data:M;if(!e.length)return[];let l=new Map;return e.forEach(e=>{l.set(e.time,e)}),Array.from(l.entries()).sort((e,l)=>F(e[0])-F(l[0])).map(e=>{let[,l]=e;return l})},[I.data,M]),{chartSeries:W,trendMap:P}=(0,r.useMemo)(()=>{let e=C.map(e=>({...e,riseValue:null,fallValue:null})),l=new Map;e.length&&l.set(e[0].time,"flat");for(let t=1;t<e.length;t++){let n=e[t-1],r=e[t];Number.isFinite(n.value)&&Number.isFinite(r.value)&&(r.value>n.value?(n.riseValue=n.value,r.riseValue=r.value,l.set(r.time,"up")):r.value<n.value?(n.fallValue=n.value,r.fallValue=r.value,l.set(r.time,"down")):l.set(r.time,"flat"))}return{chartSeries:e,trendMap:l}},[C]);return(0,n.jsxs)("div",{className:"w-full",children:[(0,n.jsx)("div",{className:"flex justify-end mb-4",children:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("button",{onClick:()=>D(!_),className:"p-2 rounded-full border transition-colors ".concat(_?"border-sage-green bg-sage-green/30 shadow-[0_0_20px_rgba(127,176,105,0.45)]":"border-sage-green/50 bg-transparent hover:bg-sage-green/10"),"aria-label":"Toggle chart settings",children:(0,n.jsx)(v.Z,{className:"w-4 h-4 text-sage-green"})}),_&&(0,n.jsx)("div",{className:"absolute right-0 top-full mt-3 w-72 rounded-2xl border border-sage-green/40 bg-pure-black p-4 shadow-2xl backdrop-blur z-20",children:(0,n.jsxs)("div",{className:"space-y-4 text-sage-green",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-xs uppercase tracking-[0.2em] text-sage-green/80",children:"Time Increment"}),(0,n.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:[5,10,15,30,60].map(e=>(0,n.jsxs)("button",{onClick:()=>y(e),className:"px-3 py-1.5 rounded-full text-xs font-mono transition-all ".concat(h===e?"bg-sage-green text-pure-black shadow-[0_0_15px_rgba(127,176,105,0.45)]":"border border-sage-green/30 text-sage-green hover:bg-sage-green/10"),children:[e,"m"]},e))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-xs uppercase tracking-[0.2em] text-sage-green/80",children:"Window Size"}),(0,n.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:[1,2,4,6,12,24].map(e=>(0,n.jsxs)("button",{onClick:()=>N(e),className:"px-3 py-1.5 rounded-full text-xs font-mono transition-all ".concat(w===e?"bg-sage-green text-pure-black shadow-[0_0_15px_rgba(127,176,105,0.45)]":"border border-sage-green/30 text-sage-green hover:bg-sage-green/10"),children:[e,"h"]},e))})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,n.jsx)("span",{children:"Markers"}),(0,n.jsx)("button",{onClick:()=>A(e=>!e),className:"px-3 py-1 rounded-full text-xs font-semibold transition-colors ".concat(S?"bg-sage-green text-pure-black":"border border-sage-green/30 text-sage-green hover:bg-sage-green/10"),children:S?"Visible":"Hidden"})]}),(0,n.jsx)("button",{onClick:()=>{y(10),N(2),A(!0)},className:"w-full rounded-full border border-sage-green/40 bg-transparent px-3 py-2 text-xs font-semibold uppercase tracking-wider text-sage-green hover:bg-sage-green/10 transition-colors",children:"Reset Defaults"})]})})]})}),(0,n.jsxs)("div",{className:"relative rounded-2xl border border-ink-500 bg-card-bg/70 p-4",children:[(0,n.jsx)(o.h,{width:"100%",height:420,children:(0,n.jsxs)(i.w,{data:W,margin:{top:10,right:30,left:20,bottom:20},children:[(0,n.jsx)(a.q,{strokeDasharray:"3 3",stroke:"#2D2D2D"}),(0,n.jsx)(s.K,{dataKey:"time",stroke:"#EDEDED",style:{fontSize:"12px",fontFamily:"IBM Plex Mono, monospace"},tick:{fill:"#EDEDED"}}),(0,n.jsx)(d.B,{stroke:"#EDEDED",style:{fontSize:"12px",fontFamily:"IBM Plex Mono, monospace"},tick:{fill:"#EDEDED"},domain:[e=>Number.isFinite(e)?Math.floor(e-10):0,e=>Number.isFinite(e)?Math.ceil(e+10):10],tickFormatter:e=>E?"$".concat(e.toFixed(2)):e.toFixed(2)}),(0,n.jsx)(u.u,{content:(0,n.jsx)(e=>{var l,t;let{active:r,payload:o,label:i}=e;if(!r||!(null==o?void 0:o.length))return null;let a=null===(l=o[0])||void 0===l?void 0:l.payload;if(!a)return null;let s=null!==(t=P.get(i))&&void 0!==t?t:"flat";return(0,n.jsxs)("div",{className:"rounded-2xl border border-ink-500 bg-card-bg px-3 py-2 shadow-xl",children:[(0,n.jsx)("p",{className:"text-[0.65rem] font-mono uppercase tracking-[0.3em] text-floral-white/60",children:i}),(0,n.jsxs)("p",{className:"text-sm font-mono",style:{color:"up"===s?"#14B116":"down"===s?"#BD0000":"#EDEDED"},children:[f," : $",a.value.toFixed(2)]})]})},{}),cursor:{stroke:"#EDEDED",strokeDasharray:"3 3"}}),(0,n.jsx)(c.x,{type:"linear",dataKey:"value",stroke:"#F5F5F580",strokeWidth:2,dot:!!S&&(0,n.jsx)(b,{}),activeDot:!!S&&{r:6,fill:"#FFFFFF",stroke:"#171717",strokeWidth:1.5},connectNulls:!0,isAnimationActive:!1}),(0,n.jsx)(c.x,{type:"linear",dataKey:"riseValue",stroke:"#14B116",strokeWidth:2.5,dot:!1,connectNulls:!1,isAnimationActive:!1}),(0,n.jsx)(c.x,{type:"linear",dataKey:"fallValue",stroke:"#BD0000",strokeWidth:2.5,dot:!1,connectNulls:!1,isAnimationActive:!1})]})}),I.totalWindows>1&&(0,n.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4 rounded-xl border border-ink-500 bg-ink-600/40 px-4 py-3 mt-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-xs uppercase tracking-[0.2em] text-floral-white/60",children:"Window"}),(0,n.jsxs)("p",{className:"text-sm font-semibold text-floral-white",children:[k+1," / ",I.totalWindows]})]}),(0,n.jsxs)("div",{className:"text-sm text-floral-white/70 font-mono",children:[I.startTime," - ",I.endTime]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("button",{onClick:()=>{j(e=>Math.max(0,e-1))},disabled:0===k,className:"p-2 rounded-full border border-ink-500 hover:border-sage-green disabled:opacity-40 disabled:cursor-not-allowed transition-colors bg-card-bg/70","aria-label":"Previous window",children:(0,n.jsx)(m.Z,{className:"w-4 h-4 text-floral-white"})}),(0,n.jsx)("button",{onClick:()=>{j(e=>Math.min(I.totalWindows-1,e+1))},disabled:k>=I.totalWindows-1,className:"p-2 rounded-full border border-ink-500 hover:border-sage-green disabled:opacity-40 disabled:cursor-not-allowed transition-colors bg-card-bg/70","aria-label":"Next window",children:(0,n.jsx)(g.Z,{className:"w-4 h-4 text-floral-white"})})]})]}),!C.length&&(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-floral-white/40 text-sm font-mono",children:"No datapoints available"})]})]})}},29116:function(e,l,t){t.d(l,{JU:function(){return c},M0:function(){return v},Sj:function(){return u},U3:function(){return d},e3:function(){return s}});var n=t(58528);async function r(e,l){try{var t;let r=(0,n.bR)(),o=await fetch("".concat(r).concat(e),{cache:"no-store",...l});if(!o.ok){let e="Request failed: ".concat(o.status);try{let l=await o.json();l.error?e=l.error:"string"==typeof l&&(e=l)}catch(t){let l=await o.text();l&&(e=l)}throw Error(e)}return(t=await o.json())&&"object"==typeof t&&"data"in t?t.data:t}catch(e){if(e instanceof Error){if(e.message.includes("fetch")||e.message.includes("Failed to fetch")){let e=(0,n.cQ)();throw Error("Cannot connect to backend server. Please ensure the backend is running on ".concat(e,"."))}throw e}throw Error("An unknown error occurred")}}function o(e){var l,t,n,r,o,i,a,s,d,u,c,v,m,g,b,f,x,p,h,y,w;let N="number"==typeof(null==e?void 0:e.performance)?e.performance:"number"==typeof(null==e?void 0:null===(l=e.performance)||void 0===l?void 0:l.pnl)?e.performance.pnl:0,k=Array.isArray(null==e?void 0:e.trades)?e.trades.length:"number"==typeof(null==e?void 0:e.trades)?e.trades:0;return{id:String(null!==(i=null==e?void 0:e.id)&&void 0!==i?i:""),name:String(null!==(a=null==e?void 0:e.name)&&void 0!==a?a:"Unnamed Agent"),role:String(null!==(s=null==e?void 0:e.role)&&void 0!==s?s:"agent"),performance:Number(N||0),trades:Number(k||0),status:null!==(d=null==e?void 0:e.status)&&void 0!==d?d:"idle",sectorId:null!==(c=null!==(u=null==e?void 0:e.sectorId)&&void 0!==u?u:null==e?void 0:e.sector_id)&&void 0!==c?c:null,sectorSymbol:null!==(m=null!==(v=null==e?void 0:e.sectorSymbol)&&void 0!==v?v:null==e?void 0:e.sector_symbol)&&void 0!==m?m:void 0,sectorName:null!==(b=null!==(g=null==e?void 0:e.sectorName)&&void 0!==g?g:null==e?void 0:e.sector_name)&&void 0!==b?b:void 0,personality:{riskTolerance:null!==(x=null!==(f=null==e?void 0:null===(t=e.personality)||void 0===t?void 0:t.riskTolerance)&&void 0!==f?f:null==e?void 0:null===(n=e.personality)||void 0===n?void 0:n.risk_tolerance)&&void 0!==x?x:"Unknown",decisionStyle:null!==(h=null!==(p=null==e?void 0:null===(r=e.personality)||void 0===r?void 0:r.decisionStyle)&&void 0!==p?p:null==e?void 0:null===(o=e.personality)||void 0===o?void 0:o.decision_style)&&void 0!==h?h:"Unknown"},createdAt:null!==(w=null!==(y=null==e?void 0:e.createdAt)&&void 0!==y?y:null==e?void 0:e.created_at)&&void 0!==w?w:new Date().toISOString()}}function i(e){var l,t,n,r,o,i,a,s,d,u,c,v,m;let g=Array.isArray(null==e?void 0:e.messages)?e.messages.map((l,t)=>{var n,r,o,i,a,s;return{id:String(null!==(r=null==l?void 0:l.id)&&void 0!==r?r:"".concat(null!==(n=null==e?void 0:e.id)&&void 0!==n?n:"disc","-msg-").concat(t)),agentName:String(null!==(i=null!==(o=null==l?void 0:l.agentName)&&void 0!==o?o:null==l?void 0:l.agent_name)&&void 0!==i?i:"Unknown Agent"),content:String(null!==(a=null==l?void 0:l.content)&&void 0!==a?a:""),timestamp:null!==(s=null==l?void 0:l.timestamp)&&void 0!==s?s:new Date().toISOString()}}):[];return{id:String(null!==(l=null==e?void 0:e.id)&&void 0!==l?l:""),sectorId:String(null!==(n=null!==(t=null==e?void 0:e.sectorId)&&void 0!==t?t:null==e?void 0:e.sector_id)&&void 0!==n?n:""),title:String(null!==(r=null==e?void 0:e.title)&&void 0!==r?r:"Untitled discussion"),status:null!==(o=null==e?void 0:e.status)&&void 0!==o?o:"in_progress",agentIds:Array.isArray(null==e?void 0:e.agentIds)?e.agentIds.map(e=>String(e)):Array.isArray(null==e?void 0:e.agent_ids)?e.agent_ids.map(e=>String(e)):[],messages:g,createdAt:null!==(a=null!==(i=null==e?void 0:e.createdAt)&&void 0!==i?i:null==e?void 0:e.created_at)&&void 0!==a?a:new Date().toISOString(),updatedAt:null!==(d=null!==(s=null==e?void 0:e.updatedAt)&&void 0!==s?s:null==e?void 0:e.updated_at)&&void 0!==d?d:new Date().toISOString(),sectorSymbol:null!==(c=null!==(u=null==e?void 0:e.sectorSymbol)&&void 0!==u?u:null==e?void 0:e.sector_symbol)&&void 0!==c?c:void 0,sectorName:null!==(m=null!==(v=null==e?void 0:e.sectorName)&&void 0!==v?v:null==e?void 0:e.sector_name)&&void 0!==m?m:void 0}}function a(e){var l,t,n,r,a,s,d,u,c,v,m,g,b,f,x,p,h,y,w,N,k;let j=Number(null!==(t=null!==(l=null==e?void 0:e.currentPrice)&&void 0!==l?l:null==e?void 0:e.price)&&void 0!==t?t:0),S=Array.isArray(null==e?void 0:e.agents)?e.agents.map(l=>{var t,n,r,i,a;return o({...l,sectorId:null!==(t=null==l?void 0:l.sectorId)&&void 0!==t?t:null==e?void 0:e.id,sectorSymbol:null!==(r=null!==(n=null==l?void 0:l.sectorSymbol)&&void 0!==n?n:null==e?void 0:e.symbol)&&void 0!==r?r:null==e?void 0:e.sectorSymbol,sectorName:null!==(a=null!==(i=null==l?void 0:l.sectorName)&&void 0!==i?i:null==e?void 0:e.name)&&void 0!==a?a:null==e?void 0:e.sectorName})}):[],A=Array.isArray(null==e?void 0:e.candleData)?e.candleData.map((e,l)=>(function(e,l,t){if(e&&"string"==typeof e.time&&"number"==typeof e.value)return e;let n="number"==typeof(null==e?void 0:e.value)?e.value:"number"==typeof(null==e?void 0:e.close)?e.close:"number"==typeof t?t:0,r="".concat((2*l%24).toString().padStart(2,"0"),":").concat((5*l%60).toString().padStart(2,"0"));return Number.isFinite(n)?{time:r,value:Number(n.toFixed(2))}:null})(e,l,j)).filter(e=>!!e):[],_=Array.isArray(null==e?void 0:e.discussions)?e.discussions.map(l=>{var t,n,r,o,a;return i({...l,sectorId:null!==(t=null==l?void 0:l.sectorId)&&void 0!==t?t:null==e?void 0:e.id,sectorSymbol:null!==(r=null!==(n=null==l?void 0:l.sectorSymbol)&&void 0!==n?n:null==e?void 0:e.symbol)&&void 0!==r?r:null==e?void 0:e.sectorSymbol,sectorName:null!==(a=null!==(o=null==l?void 0:l.sectorName)&&void 0!==o?o:null==e?void 0:e.name)&&void 0!==a?a:null==e?void 0:e.sectorName})}):[];return{id:String(null!==(n=null==e?void 0:e.id)&&void 0!==n?n:""),name:String(null!==(a=null!==(r=null==e?void 0:e.name)&&void 0!==r?r:null==e?void 0:e.sectorName)&&void 0!==a?a:"Unknown Sector"),symbol:String(null!==(d=null!==(s=null==e?void 0:e.symbol)&&void 0!==s?s:null==e?void 0:e.sectorSymbol)&&void 0!==d?d:"SECT"),currentPrice:Number.isFinite(j)?Number(j.toFixed(2)):0,change:Number(null!==(u=null==e?void 0:e.change)&&void 0!==u?u:0),changePercent:Number(null!==(v=null!==(c=null==e?void 0:e.changePercent)&&void 0!==c?c:null==e?void 0:e.change_percent)&&void 0!==v?v:0),volume:Number(null!==(m=null==e?void 0:e.volume)&&void 0!==m?m:0),agents:S,activeAgents:Number(null!==(b=null!==(g=null==e?void 0:e.activeAgents)&&void 0!==g?g:null==e?void 0:e.active_agents)&&void 0!==b?b:S.filter(e=>"active"===e.status).length),buyAgents:Number(null!==(x=null!==(f=null==e?void 0:e.buyAgents)&&void 0!==f?f:null==e?void 0:e.buy_agents)&&void 0!==x?x:0),sellAgents:Number(null!==(h=null!==(p=null==e?void 0:e.sellAgents)&&void 0!==p?p:null==e?void 0:e.sell_agents)&&void 0!==h?h:0),statusPercent:Number(null!==(w=null!==(y=null==e?void 0:e.statusPercent)&&void 0!==y?y:null==e?void 0:e.status_percent)&&void 0!==w?w:0),candleData:A,discussions:_,createdAt:null!==(k=null!==(N=null==e?void 0:e.createdAt)&&void 0!==N?N:null==e?void 0:e.created_at)&&void 0!==k?k:new Date().toISOString()}}async function s(){try{let e=await r("/sectors");if(!e)return[];return Array.isArray(e)?e.map(a):[]}catch(e){throw console.error("Error fetching sectors:",e),e}}async function d(e){if(!e)return null;let l=await r("/sectors/".concat(e));return l?a(l):null}async function u(){let e=await r("/agents");return Array.isArray(e)?e.map(e=>o(e)):[]}async function c(){let e=await r("/discussions");return Array.isArray(e)?e.map(i):[]}async function v(e,l){return a(await r("/sectors",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sectorName:e,sectorSymbol:l})}))}t(40257),(0,n.bR)(),(0,n.cQ)()},58528:function(e,l,t){t.d(l,{P:function(){return r},bR:function(){return i},cQ:function(){return o}});var n=t(40257);function r(){return void 0!==window.__TAURI__}function o(){return r()?"http://127.0.0.1:4000":n.env.NEXT_PUBLIC_MAX_BACKEND_URL||"http://localhost:3001"}function i(){let e=o();return"".concat(e.replace(/\/$/,""),"/api")}}}]);